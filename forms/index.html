<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Associate Attorney - Help with filling out forms</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 p-8">
    <h1 class="text-3xl font-bold mb-8">AI Associate Attorney - Legal Forms</h1>
    
    <div class="mb-8 flex flex-wrap gap-4">
        <div class="w-full md:w-64">
            <label for="search" class="block text-sm font-medium text-gray-700 mb-2">Search Forms</label>
            <input type="text" id="search" placeholder="Search forms..." class="w-full p-2 border rounded-md">
        </div>
        
        <div class="w-full md:w-64">
            <label for="jurisdiction" class="block text-sm font-medium text-gray-700 mb-2">Jurisdiction</label>
            <select id="jurisdiction" class="w-full p-2 border rounded-md">
                <option value="">Select Jurisdiction</option>
            </select>
        </div>
        
        <div class="w-full md:w-64">
            <label for="area" class="block text-sm font-medium text-gray-700 mb-2">Area of Law</label>
            <select id="area" class="w-full p-2 border rounded-md" disabled>
                <option value="">Select Area</option>
            </select>
        </div>
    </div>

    <!-- Forms List -->
    <div id="formsList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- Forms will be dynamically inserted here -->
    </div>

    <script>
        async function loadFormsData() {
            try {
                const response = await fetch('forms_list.json');
                const data = await response.json();
                initializeSelectors(data);
                displayAllForms(data);
            } catch (error) {
                console.error('Error loading forms:', error);
                document.getElementById('formsList').innerHTML = 
                    '<p class="text-red-600">Error loading forms. Please try again later.</p>';
            }
        }

        function initializeSelectors(data) {
            const jurisdictionSelect = document.getElementById('jurisdiction');
            const areaSelect = document.getElementById('area');
            
            // Populate jurisdictions
            Object.keys(data.jurisdictions).forEach(jurisdiction => {
                const option = document.createElement('option');
                option.value = jurisdiction;
                option.textContent = jurisdiction.charAt(0).toUpperCase() + jurisdiction.slice(1);
                jurisdictionSelect.appendChild(option);
            });

            // Handle jurisdiction change
            jurisdictionSelect.addEventListener('change', () => {
                const selectedJurisdiction = jurisdictionSelect.value;
                updateAreaSelect(data, selectedJurisdiction);
            });

            // Handle area change
            areaSelect.addEventListener('change', () => {
                const selectedJurisdiction = jurisdictionSelect.value;
                const selectedArea = areaSelect.value;
                displayForms(data, selectedJurisdiction, selectedArea);
            });

            // Handle search input
            const searchInput = document.getElementById('search');
            searchInput.addEventListener('input', () => {
                const selectedJurisdiction = jurisdictionSelect.value;
                const selectedArea = areaSelect.value;
                const searchTerm = searchInput.value.toLowerCase();
                
                if (selectedJurisdiction && selectedArea) {
                    displayForms(data, selectedJurisdiction, selectedArea, searchTerm);
                } else {
                    displayAllForms(data, searchTerm);
                }
            });
        }

        function updateAreaSelect(data, jurisdiction) {
            const areaSelect = document.getElementById('area');
            areaSelect.innerHTML = '<option value="">Select Area</option>';
            
            if (jurisdiction) {
                const areas = Object.keys(data.jurisdictions[jurisdiction].areas);
                areas.forEach(area => {
                    const option = document.createElement('option');
                    option.value = area;
                    option.textContent = area.split('-').map(word => 
                        word.charAt(0).toUpperCase() + word.slice(1)
                    ).join(' ');
                    areaSelect.appendChild(option);
                });
                areaSelect.disabled = false;
            } else {
                areaSelect.disabled = true;
            }
            
            document.getElementById('formsList').innerHTML = '';
        }

        function displayForms(data, jurisdiction, area) {
            const formsList = document.getElementById('formsList');
            
            if (!jurisdiction || !area) {
                formsList.innerHTML = '';
                return;
            }

            const forms = data.jurisdictions[jurisdiction].areas[area].forms;
            
            formsList.innerHTML = forms.map(form => `
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="font-semibold text-lg mb-2">${form.name}</h3>
                    <div class="flex justify-between items-center mt-4">
                        <span class="text-sm text-gray-500">${jurisdiction} - ${area}</span>
                        <a href="${form.path}" 
                           class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 text-sm">
                            Fill Form
                        </a>
                    </div>
                </div>
            `).join('');
        }

        function displayAllForms(data, searchTerm = '') {
            const formsList = document.getElementById('formsList');
            const allForms = [];
            
            // Collect all forms across jurisdictions and areas
            Object.entries(data.jurisdictions).forEach(([jurisdiction, jurisdictionData]) => {
                Object.entries(jurisdictionData.areas).forEach(([area, areaData]) => {
                    areaData.forms.forEach(form => {
                        allForms.push({
                            ...form,
                            jurisdiction,
                            area
                        });
                    });
                });
            });
            
            // Filter forms based on search term
            const filteredForms = searchTerm ? 
                allForms.filter(form => form.name.toLowerCase().includes(searchTerm)) : 
                allForms;
            
            // Display first 50 filtered forms
            const formsToDisplay = filteredForms.slice(0, 50);
            
            if (formsToDisplay.length === 0) {
                formsList.innerHTML = '<p class="text-gray-600">No forms found matching your search.</p>';
                return;
            }

            formsList.innerHTML = formsToDisplay.map(form => `
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="font-semibold text-lg mb-2">${form.name}</h3>
                    <div class="flex justify-between items-center mt-4">
                        <span class="text-sm text-gray-500">${form.jurisdiction} - ${form.area}</span>
                        <a href="${form.path}" 
                           class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 text-sm">
                            Fill Form
                        </a>
                    </div>
                </div>
            `).join('');
        }

        // Load forms when page loads
        document.addEventListener('DOMContentLoaded', loadFormsData);
    </script>
</body>
</html>
